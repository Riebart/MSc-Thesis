(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     48659,       1172]
NotebookOptionsPosition[     46879,       1114]
NotebookOutlinePosition[     47220,       1129]
CellTagsIndexPosition[     47177,       1126]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "readTable", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readTable", "[", 
   RowBox[{
    RowBox[{"file_String", "?", "FileExistsQ"}], ",", 
    RowBox[{"chunkSize_:", " ", "100"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "str", ",", "stream", ",", "dataChunk", ",", "result", ",", "linkedList",
       ",", "add"}], "}"}], ",", 
    RowBox[{
     RowBox[{"SetAttributes", "[", 
      RowBox[{"linkedList", ",", "HoldAllComplete"}], "]"}], ";", 
     RowBox[{
      RowBox[{"add", "[", 
       RowBox[{"ll_", ",", "value_"}], "]"}], ":=", 
      RowBox[{"linkedList", "[", 
       RowBox[{"ll", ",", "value"}], "]"}]}], ";", 
     RowBox[{"stream", "=", 
      RowBox[{"StringToStream", "[", 
       RowBox[{"Import", "[", 
        RowBox[{"file", ",", "\"\<String\>\""}], "]"}], "]"}]}], ";", 
     RowBox[{"Internal`WithLocalSettings", "[", 
      RowBox[{"Null", ",", 
       RowBox[{"(*", 
        RowBox[{"main", " ", "code"}], "*)"}], 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"linkedList", "[", "]"}]}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"dataChunk", "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"dataChunk", "=", 
            RowBox[{"ImportString", "[", 
             RowBox[{
              RowBox[{"StringJoin", "[", 
               RowBox[{"Riffle", "[", 
                RowBox[{
                 RowBox[{"ReadList", "[", 
                  RowBox[{"stream", ",", "\"\<String\>\"", ",", "chunkSize"}],
                   "]"}], ",", "\"\<\\n\>\""}], "]"}], "]"}], ",", 
              "\"\<Table\>\""}], "]"}]}], ";", 
           RowBox[{"result", "=", 
            RowBox[{"add", "[", 
             RowBox[{"result", ",", "dataChunk"}], "]"}]}], ";"}]}], "]"}], 
        ";", 
        RowBox[{"result", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"result", ",", "Infinity", ",", "linkedList"}], "]"}]}]}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{"clean", "-", "up"}], "*)"}], 
       RowBox[{"Close", "[", "stream", "]"}]}], "]"}], ";", 
     RowBox[{"Join", "@@", "result"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.563819579038275*^9, 3.5638195827074847`*^9}, 
   3.5638216283834906`*^9}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.5638254978168097`*^9, 3.563825514695775*^9}}],

Cell[BoxData[
 RowBox[{"Step1", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ent", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"dir", "<>", "fname", "<>", "\"\<.ent\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dom", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"dir", "<>", "fname", "<>", "\"\<.dom\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"raw", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"ent", ",", "dom"}], "}"}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.563823199716366*^9, 3.5638232407177105`*^9}, {
   3.5638234302515516`*^9, 3.5638234312996116`*^9}, 3.5638259445013585`*^9, {
   3.5726413063830166`*^9, 3.5726413081889987`*^9}, {3.5726452699251833`*^9, 
   3.5726452734776306`*^9}, {3.5726453222941513`*^9, 3.572645324193158*^9}, {
   3.5726453548578367`*^9, 3.5726453625138783`*^9}}],

Cell[BoxData[
 RowBox[{"Step2", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gathered", "=", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"raw", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"uniqued", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "gathered", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"gathered", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"gathered", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sortedC", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"uniqued", ",", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indexed", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "sortedC", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"sortedC", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"domains", "=", "indexed"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.562628009799203*^9, 3.5626280415013084`*^9}, {
   3.5626282398650293`*^9, 3.5626282735981207`*^9}, {3.5626289058087883`*^9, 
   3.5626289309950027`*^9}, {3.562629466899688*^9, 3.562629547265873*^9}, {
   3.5626296281502705`*^9, 3.5626296762864976`*^9}, {3.5626297340306964`*^9, 
   3.5626297964878693`*^9}, {3.562629833878973*^9, 3.562629860511046*^9}, {
   3.5626298976871834`*^9, 3.5626298979771843`*^9}, {3.5626299568093495`*^9, 
   3.562629958349352*^9}, 3.5626301393158007`*^9, {3.562632375506789*^9, 
   3.562632375827808*^9}, {3.563814561090002*^9, 3.56381457076273*^9}, {
   3.5638152067129855`*^9, 3.5638152197776446`*^9}, {3.5638261162791834`*^9, 
   3.5638261410406*^9}, {3.5638261869152236`*^9, 3.563826189072347*^9}}],

Cell[BoxData[
 RowBox[{"Step4", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsIO", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "domains", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Abs", "[", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"domains", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fun", "=", "Mean"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ptsO", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "domains", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"v", "=", 
             RowBox[{"fun", "[", 
              RowBox[{
               RowBox[{"domains", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Sow", "[", 
             RowBox[{"{", 
              RowBox[{"i", ",", "v"}], "}"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ptsEO", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "domains", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"v", "=", 
             RowBox[{"fun", "[", 
              RowBox[{
               RowBox[{"domains", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Sow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "v"}], "}"}], ",", 
               RowBox[{"ErrorBar", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"domains", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "v"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"domains", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "v"}]}], 
                 "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ptsEOL", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "domains", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"v", "=", 
             RowBox[{"fun", "[", 
              RowBox[{
               RowBox[{"domains", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Sow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Log10", "[", "v", "]"}]}], "}"}], ",", 
               RowBox[{"ErrorBar", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Log10", "[", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"domains", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                   RowBox[{"Log10", "[", "v", "]"}]}], " ", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Log10", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"domains", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                   RowBox[{"Log10", "[", "v", "]"}]}]}], " ", 
                 "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ptsOL", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "domains", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"v", "=", 
             RowBox[{"fun", "[", 
              RowBox[{
               RowBox[{"domains", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Sow", "[", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Log10", "[", "v", "]"}]}], "}"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"size", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Round", "[", 
           SuperscriptBox["2", 
            RowBox[{"4", 
             RowBox[{"Log10", "[", 
              RowBox[{"Length", "[", "domains", "]"}], "]"}]}]], "]"}], ",", 
          "minsize"}], "]"}], ",", "maxsize"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "domains", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.562604083828802*^9, 3.5626040847488036`*^9}, {
   3.5626041822854204`*^9, 3.562604182607422*^9}, {3.562604228705814*^9, 
   3.5626042398378367`*^9}, {3.562604276035926*^9, 3.5626043710141535`*^9}, 
   3.562604669429005*^9, {3.5626048038509536`*^9, 3.562604824273056*^9}, {
   3.562604858977255*^9, 3.562604877415309*^9}, {3.562604919191408*^9, 
   3.562604928021426*^9}, {3.562604994850338*^9, 3.5626050173443937`*^9}, {
   3.5626249914470406`*^9, 3.5626250026106796`*^9}, {3.5626252214981995`*^9, 
   3.562625224171352*^9}, {3.5626257697665586`*^9, 3.5626257707156124`*^9}, {
   3.5626258366483836`*^9, 3.5626258373044214`*^9}, {3.56263028807159*^9, 
   3.562630288721591*^9}, {3.5626317592055387`*^9, 3.562631817629881*^9}, {
   3.562632041130664*^9, 3.562632065829077*^9}, {3.5632073510436316`*^9, 
   3.563207359659654*^9}, {3.5632075446701574`*^9, 3.563207588318287*^9}, {
   3.5632076212183714`*^9, 3.5632076433404255`*^9}, {3.5638145739081297`*^9, 
   3.5638145836333647`*^9}, {3.5638157635917006`*^9, 
   3.5638157667661033`*^9}, {3.5638160107660875`*^9, 
   3.5638160125458136`*^9}, {3.56381626152993*^9, 3.5638162618019648`*^9}, {
   3.572641466997357*^9, 3.5726414676530313`*^9}, {3.5726438786551*^9, 
   3.5726438789271727`*^9}, {3.5726995521354537`*^9, 3.572699552814539*^9}}],

Cell[BoxData[
 RowBox[{"Step5", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "dir", "<>", "\"\<Plots\\\\\>\"", "<>", "fname", "<>", 
        "\"\<E.jpg\>\""}], ",", 
       RowBox[{"Overlay", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ErrorListPlot", "[", 
           RowBox[{"ptsEO", ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "pmax"}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"True", ",", "True", ",", "True", ",", "False"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Blue", ",", "Automatic", ",", "Automatic"}], 
              "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"ptsIO", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"False", ",", "False", ",", "False", ",", "True"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Automatic", ",", "Automatic", ",", "Red"}], 
              "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"None", ",", "None", ",", "None", ",", "All"}], 
              "}"}]}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "dir", "<>", "\"\<Plots\\\\\>\"", "<>", "fname", "<>", 
        "\"\<EL.jpg\>\""}], ",", 
       RowBox[{"Overlay", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ErrorListPlot", "[", 
           RowBox[{"ptsEOL", ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Log", "[", "pmax", "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"True", ",", "True", ",", "True", ",", "False"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Blue", ",", "Automatic", ",", "Automatic"}], 
              "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"ptsIO", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"False", ",", "False", ",", "False", ",", "True"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Automatic", ",", "Automatic", ",", "Red"}], 
              "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"None", ",", "None", ",", "None", ",", "All"}], 
              "}"}]}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}]}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.562632229726451*^9, 3.5626322468304296`*^9}, {
  3.562632422175459*^9, 3.5626324235855393`*^9}, {3.563207238594206*^9, 
  3.5632072532402554`*^9}, {3.5632073289515743`*^9, 3.563207345760623*^9}, {
  3.5632076469124317`*^9, 3.5632076844945593`*^9}, {3.5632087814167137`*^9, 
  3.5632087848687363`*^9}, {3.563814594363727*^9, 3.563814629302664*^9}, {
  3.5638152371158466`*^9, 3.563815239184609*^9}, {3.563815993030835*^9, 
  3.5638160076716948`*^9}, {3.5638162520567274`*^9, 3.5638162648948574`*^9}, {
  3.572641310810198*^9, 3.572641312919261*^9}, {3.5726452741788187`*^9, 
  3.5726452747544713`*^9}, {3.5726453227032604`*^9, 3.5726453230118427`*^9}}],

Cell[BoxData[
 RowBox[{"Step6", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "dir", "<>", "\"\<Plots\\\\\>\"", "<>", "fname", "<>", 
        "\"\<.jpg\>\""}], ",", 
       RowBox[{"Overlay", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{"ptsO", ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "pmax"}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", 
                FractionBox["1000", 
                 RowBox[{"Length", "[", "raw", "]"}]], "]"}], ",", "Blue"}], 
              "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"True", ",", "True", ",", "True", ",", "False"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Blue", ",", "Automatic", ",", "Automatic"}], 
              "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"ptsIO", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", 
                FractionBox["1000", 
                 RowBox[{"Length", "[", "raw", "]"}]], "]"}], ",", "Red"}], 
              "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"False", ",", "False", ",", "False", ",", "True"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Automatic", ",", "Automatic", ",", "Red"}], 
              "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"None", ",", "None", ",", "None", ",", "All"}], 
              "}"}]}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
       "dir", "<>", "\"\<Plots\\\\\>\"", "<>", "fname", "<>", 
        "\"\<L.jpg\>\""}], ",", 
       RowBox[{"Overlay", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{"ptsOL", ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Log", "[", "pmax", "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", 
                FractionBox["1000", 
                 RowBox[{"Length", "[", "raw", "]"}]], "]"}], ",", "Blue"}], 
              "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"True", ",", "True", ",", "True", ",", "False"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Blue", ",", "Automatic", ",", "Automatic"}], 
              "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"ptsIO", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", 
                FractionBox["1000", 
                 RowBox[{"Length", "[", "raw", "]"}]], "]"}], ",", "Red"}], 
              "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
            RowBox[{"Joined", "\[Rule]", "False"}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"False", ",", "False", ",", "False", ",", "True"}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "Automatic", ",", "Automatic", ",", "Automatic", ",", "Red"}], 
              "}"}]}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"None", ",", "None", ",", "None", ",", "All"}], 
              "}"}]}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}]}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5626318271914277`*^9, 3.562631829406554*^9}, {
  3.5626320223925924`*^9, 3.5626320247677283`*^9}, {3.56263224963459*^9, 
  3.5626322533168006`*^9}, {3.562632410539793*^9, 3.562632420937388*^9}, {
  3.5632072586522703`*^9, 3.56320726207028*^9}, {3.5632076657724967`*^9, 
  3.5632076763245316`*^9}, {3.5632087707986507`*^9, 3.5632087778726883`*^9}, {
  3.5638146334126854`*^9, 3.5638146404430785`*^9}, {3.5638152405332804`*^9, 
  3.5638152416224184`*^9}, {3.5638159872070956`*^9, 3.5638160045382967`*^9}, {
  3.563816267948245*^9, 3.5638162682117786`*^9}, {3.5726412897575827`*^9, 
  3.572641314794261*^9}, {3.5726452752205954`*^9, 3.572645275694722*^9}, {
  3.572645323214897*^9, 3.572645323443458*^9}, {3.572701873200449*^9, 
  3.572701921659608*^9}, {3.572702051452104*^9, 3.5727020579959354`*^9}, {
  3.572702151459814*^9, 3.572702156811495*^9}}],

Cell[CellGroupData[{

Cell["Data Collection", "Title",
 CellChangeTimes->{{3.572664300410043*^9, 3.5726643166103687`*^9}}],

Cell["\<\
Collects the data not from one of the ' topX' files, but from the raw entropy \
and domain information extracted from the XML files.\
\>", "Text",
 CellChangeTimes->{{3.5726643332402997`*^9, 3.5726643586455746`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", "=", "\"\<E:\\\\Working\\\\300s\\\\Individual\\\\\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "dir", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"efiles", "=", 
   RowBox[{"FileNames", "[", "\"\<raw\\\\*ent\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfiles", "=", 
   RowBox[{"FileNames", "[", "\"\<raw\\\\*dom\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topcount", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "efiles", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"\"\<top\>\"", "<>", 
    RowBox[{"ToString", "[", "topcount", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minsize", "=", "4096"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxsize", "=", "4096"}], ";"}]}], "Input",
 CellChangeTimes->{{3.572664319161043*^9, 3.572664326058383*^9}, {
  3.572666664943657*^9, 3.5726667646793327`*^9}, {3.572666827352298*^9, 
  3.572666827807356*^9}, {3.572666858504257*^9, 3.572666869863701*^9}, {
  3.5726672217524242`*^9, 3.572667222391506*^9}, {3.5726995410030403`*^9, 
  3.572699545985672*^9}, {3.572700142083433*^9, 3.5727001433535943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"raw", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Reap", "[", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "efiles", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Sow", "[", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ReadList", "[", 
                 RowBox[{
                  RowBox[{"efiles", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "Real", ",", 
                  "topcount"}], "]"}], ",", 
                RowBox[{"ReadList", "[", 
                 RowBox[{
                  RowBox[{"dfiles", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "String", ",", 
                  "topcount"}], "]"}]}], "}"}], "]"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5726647925773134`*^9, 3.5726647951605034`*^9}, {
  3.5726648456884794`*^9, 3.5726648751853476`*^9}, {3.5726649064096756`*^9, 
  3.5726649173996067`*^9}, {3.5726649540878935`*^9, 3.5726649543524632`*^9}, {
  3.5726651916657596`*^9, 3.5726652085692687`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Step2", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Step4", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Step5", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Step6", "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.5726666277669315`*^9, 3.5726666380392375`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.030999999999998806`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.572666639829465*^9, 3.572666687683547*^9, {3.572666726467476*^9, 
   3.57266674207946*^9}, 3.5726667800892963`*^9, 3.5726668365314646`*^9, 
   3.5726668724750333`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.572666639829465*^9, 3.572666687683547*^9, {3.572666726467476*^9, 
   3.57266674207946*^9}, 3.5726667800892963`*^9, 3.5726668365314646`*^9, 
   3.5726668724860344`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.125`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.572666639829465*^9, 3.572666687683547*^9, {3.572666726467476*^9, 
   3.57266674207946*^9}, 3.5726667800892963`*^9, 3.5726668365314646`*^9, 
   3.572666872770071*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.10899999999999821`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.572666639829465*^9, 3.572666687683547*^9, {3.572666726467476*^9, 
   3.57266674207946*^9}, 3.5726667800892963`*^9, 3.5726668365314646`*^9, 
   3.5726668729961047`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"topcount", "=", "52"}], ",", 
   RowBox[{"topcount", "\[LessEqual]", "250"}], ",", 
   RowBox[{"topcount", "+=", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"raw", "=", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Reap", "[", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", 
               RowBox[{"Length", "[", "efiles", "]"}]}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Sow", "[", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ReadList", "[", 
                   RowBox[{
                    RowBox[{"efiles", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Real", ",", 
                    "topcount"}], "]"}], ",", 
                  RowBox[{"ReadList", "[", 
                   RowBox[{
                    RowBox[{"dfiles", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "String", ",", 
                    "topcount"}], "]"}]}], "}"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fname", "=", 
     RowBox[{"\"\<top\>\"", "<>", 
      RowBox[{"ToString", "[", "topcount", "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Step2", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Step4", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Step5", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Step6", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.572666878911851*^9, 3.572666939465547*^9}, {
   3.572666983082091*^9, 3.5726670203868313`*^9}, {3.572667195795125*^9, 
   3.572667209185828*^9}, {3.572700081171691*^9, 3.5727000813317113`*^9}, {
   3.5727016379095445`*^9, 3.572701645564517*^9}, {3.572701678733733*^9, 
   3.5727016969620504`*^9}, {3.572701814717016*^9, 3.5727018332853756`*^9}, 
   3.5727019269492807`*^9, {3.572702410253707*^9, 3.5727024124379835`*^9}, {
   3.5727030252628717`*^9, 3.5727030306215515`*^9}, {3.5727031303102217`*^9, 
   3.5727031304702415`*^9}, {3.5727031871104407`*^9, 
   3.5727031873174667`*^9}, {3.5727116574419765`*^9, 3.572711657704012*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Actual usage", "Title",
 CellChangeTimes->{{3.572644380341417*^9, 3.5726443912673264`*^9}}],

Cell["\<\
This algorithm does the following:
- The complete PCAP file is run through, with XML files put out every \
interval. The output XML files are sorted by the length-weighted entropy, \
highest to lowest.
- The domain name and LEW of the top X from each XML file and put into a \
single CSV file representing the entire PCAP file. 
- The resulting CSV file is then aggregated by domain name, and the number of \
time each domain appears is recorded with the list then sorted by this value.
- This data then becomes the red plot which has the least common domain on \
the left, and most common on the right, with the vertical axis being the \
number of times that domain appeared in the aggregate list. See the \
assignment of ptsIO in Step4[].
- The data is then plotted again, but this time the vertical axis is the \
digestion of the LWEs that the domain obtained that got it into the list. \
Error bars are optionally plotted showing the minimum and maximum values \
obtained by that domain. See the rest of the assignments in Step4.

Things you can get from these plots:

- All plots show an exceptionally long tail on on the number of occurrences \
plots. This is pretty much excpected that it follow a power law.
\
\>", "Text",
 CellChangeTimes->{{3.5726430648785477`*^9, 3.5726431938709536`*^9}, {
   3.572643573455701*^9, 3.572643610695129*^9}, {3.572643665943365*^9, 
   3.5726436791994114`*^9}, {3.5726437897838964`*^9, 
   3.5726438284552107`*^9}, {3.572644029319286*^9, 3.5726441304312553`*^9}, {
   3.572644417023695*^9, 3.5726444309849195`*^9}, {3.5726450155208282`*^9, 
   3.5726450241756363`*^9}, {3.5726471568404655`*^9, 3.572647173848502*^9}, {
   3.572647842600874*^9, 3.5726478684727745`*^9}, 3.572647908032826*^9, {
   3.5726479542006397`*^9, 3.572647966640958*^9}, {3.5726484766169806`*^9, 
   3.5726484834408007`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"maxsize", "=", "2048"}], "\[IndentingNewLine]", 
 RowBox[{"dir", "=", 
  "\"\<E:\\\\Working\\\\300s\\\\Pre-digested\\\\\>\""}], \
"\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", "\"\<top10\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.563814645920774*^9, 3.563814647944531*^9}, {
   3.5638146788314533`*^9, 3.5638147013048067`*^9}, {3.5638152515761824`*^9, 
   3.563815256390794*^9}, {3.5638157730994077`*^9, 3.5638157733514395`*^9}, {
   3.5638160168203564`*^9, 3.5638160179900045`*^9}, {3.5638161373586626`*^9, 
   3.5638161392964087`*^9}, 3.563816324660947*^9, {3.5638165257919874`*^9, 
   3.5638165260775237`*^9}, {3.5638169929008026`*^9, 
   3.5638169932648487`*^9}, {3.563817515379149*^9, 3.5638175156521835`*^9}, {
   3.56382346291542*^9, 3.563823464827529*^9}, {3.5638256442041826`*^9, 
   3.5638256445462017`*^9}, {3.564501611220627*^9, 3.5645016126527987`*^9}, 
   3.5645017009280167`*^9, {3.564501781243225*^9, 3.5645017814902573`*^9}, {
   3.5645021484637156`*^9, 3.5645021488237534`*^9}, {3.572641274335472*^9, 
   3.572641283639451*^9}, {3.572641316013091*^9, 3.572641323055464*^9}, {
   3.572641378191676*^9, 3.5726413913836946`*^9}, {3.572641471616089*^9, 
   3.5726414766154227`*^9}, {3.5726415098077807`*^9, 
   3.5726415109115753`*^9}, {3.572641563359559*^9, 3.5726415702954082`*^9}, 
   3.5726417805680037`*^9, {3.572641824127617*^9, 3.5726418243756776`*^9}, {
   3.5726418867198114`*^9, 3.572641887359476*^9}, {3.572643932712525*^9, 
   3.572643953656605*^9}, 3.572645293552985*^9, {3.572645374257511*^9, 
   3.5726454057049046`*^9}, {3.572646879513497*^9, 3.5726468798490863`*^9}, {
   3.5726645827193403`*^9, 3.5726645840707006`*^9}, {3.57266465106607*^9, 
   3.572664652247385*^9}}],

Cell[BoxData["2048"], "Output",
 CellChangeTimes->{
  3.572641333992882*^9, {3.572641385704175*^9, 3.5726413918058014`*^9}, {
   3.5726414779902897`*^9, 3.572641511047606*^9}, 3.5726415709270773`*^9, {
   3.572641771991707*^9, 3.5726417816877923`*^9}, 3.5726418246692553`*^9, 
   3.5726418876560564`*^9, {3.572643933313179*^9, 3.572643953919675*^9}, 
   3.572645294609768*^9, 3.572645336637477*^9, {3.5726453680653596`*^9, 
   3.572645426361408*^9}, {3.572664594122882*^9, 3.572664620576438*^9}, 
   3.572664652543964*^9, 3.5726649931163025`*^9}],

Cell[BoxData["\<\"E:\\\\Working\\\\300s\\\\Pre-digested\\\\\"\>"], "Output",
 CellChangeTimes->{
  3.572641333992882*^9, {3.572641385704175*^9, 3.5726413918058014`*^9}, {
   3.5726414779902897`*^9, 3.572641511047606*^9}, 3.5726415709270773`*^9, {
   3.572641771991707*^9, 3.5726417816877923`*^9}, 3.5726418246692553`*^9, 
   3.5726418876560564`*^9, {3.572643933313179*^9, 3.572643953919675*^9}, 
   3.572645294609768*^9, 3.572645336637477*^9, {3.5726453680653596`*^9, 
   3.572645426361408*^9}, {3.572664594122882*^9, 3.572664620576438*^9}, 
   3.572664652543964*^9, 3.5726649931183033`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Step1", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Step2", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Step4", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Step5", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{"Step6", "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.572643912272067*^9, 3.572643914344119*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"13.01000000000002`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.572643938961685*^9, 3.5726439585104055`*^9}, 
   3.572645296074658*^9, 3.57264533799934*^9, {3.57264536919366*^9, 
   3.5726453927744503`*^9}, 3.5726454429113226`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.071999999999974`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.572643938961685*^9, 3.5726439585104055`*^9}, 
   3.572645296074658*^9, 3.57264533799934*^9, {3.57264536919366*^9, 
   3.5726453927744503`*^9}, 3.5726454471209507`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \
\[NoBreak]\\!\\(\\(\\(-\[Infinity]\\)\\) + \[Infinity]\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5726439412032833`*^9, 3.5726439596331987`*^9}, 
   3.5726452966653156`*^9, 3.5726453379613304`*^9, {3.5726453693031893`*^9, 
   3.5726453954676685`*^9}, 3.572645448693865*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \
\[NoBreak]\\!\\(\\(\\(-\[Infinity]\\)\\) + \[Infinity]\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5726439412032833`*^9, 3.5726439596331987`*^9}, 
   3.5726452966653156`*^9, 3.5726453379613304`*^9, {3.5726453693031893`*^9, 
   3.5726453954676685`*^9}, 3.5726454486953654`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \
\[NoBreak]\\!\\(\\(\\(-\[Infinity]\\)\\) + \[Infinity]\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5726439412032833`*^9, 3.5726439596331987`*^9}, 
   3.5726452966653156`*^9, 3.5726453379613304`*^9, {3.5726453693031893`*^9, 
   3.5726453954676685`*^9}, 3.5726454486963654`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5726439412032833`*^9, 3.5726439596331987`*^9}, 
   3.5726452966653156`*^9, 3.5726453379613304`*^9, {3.5726453693031893`*^9, 
   3.5726453954676685`*^9}, 3.572645448697866*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.4470000000000027`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.572643938961685*^9, 3.5726439585104055`*^9}, 
   3.572645296074658*^9, 3.57264533799934*^9, {3.57264536919366*^9, 
   3.5726453927744503`*^9}, 3.5726454506133766`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20.670000000000016`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.572643938961685*^9, 3.5726439585104055`*^9}, 
   3.572645296074658*^9, 3.57264533799934*^9, {3.57264536919366*^9, 
   3.5726453927744503`*^9}, 3.572645475013385*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7489999999999952`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.572643938961685*^9, 3.5726439585104055`*^9}, 
   3.572645296074658*^9, 3.57264533799934*^9, {3.57264536919366*^9, 
   3.5726453927744503`*^9}, 3.572645476154195*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sandbox", "Title",
 CellChangeTimes->{{3.572644358830674*^9, 3.57264436668777*^9}, {
  3.572644405695674*^9, 3.5726444058152122`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uniqued", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Reap", "[", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "gathered", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Sow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"gathered", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"gathered", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortedC", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{"uniqued", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexed", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Reap", "[", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "sortedC", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Sow", "[", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"sortedC", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domains", "=", "indexed"}], ";"}]}], "Input"]
}, Open  ]]
},
WindowSize->{707, 884},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 2353, 61, 272, "Input"],
Cell[2913, 83, 147, 2, 31, "Input"],
Cell[3063, 87, 1012, 23, 112, "Input"],
Cell[4078, 112, 3365, 79, 232, "Input"],
Cell[7446, 193, 8735, 204, 619, "Input"],
Cell[16184, 399, 5231, 113, 492, "Input"],
Cell[21418, 514, 6298, 140, 660, "Input"],
Cell[CellGroupData[{
Cell[27741, 658, 100, 1, 83, "Title"],
Cell[27844, 661, 226, 4, 47, "Text"],
Cell[28073, 667, 1296, 31, 192, "Input"],
Cell[29372, 700, 1633, 40, 92, "Input"],
Cell[CellGroupData[{
Cell[31030, 744, 311, 5, 92, "Input"],
Cell[31344, 751, 288, 6, 30, "Output"],
Cell[31635, 759, 270, 6, 30, "Output"],
Cell[31908, 767, 271, 6, 30, "Output"],
Cell[32182, 775, 287, 6, 30, "Output"]
}, Open  ]],
Cell[32484, 784, 2710, 60, 232, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35231, 849, 97, 1, 83, "Title"],
Cell[35331, 852, 1848, 32, 353, "Text"],
Cell[CellGroupData[{
Cell[37204, 888, 1743, 27, 72, "Input"],
Cell[38950, 917, 546, 8, 30, "Output"],
Cell[39499, 927, 591, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40127, 940, 367, 6, 112, "Input"],
Cell[40497, 948, 283, 5, 30, "Output"],
Cell[40783, 955, 283, 5, 30, "Output"],
Cell[41069, 962, 650, 13, 21, "Message"],
Cell[41722, 977, 652, 13, 21, "Message"],
Cell[42377, 992, 652, 13, 21, "Message"],
Cell[43032, 1007, 688, 13, 21, "Message"],
Cell[43723, 1022, 284, 5, 30, "Output"],
Cell[44010, 1029, 282, 5, 30, "Output"],
Cell[44295, 1036, 282, 5, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44626, 1047, 140, 2, 83, "Title"],
Cell[44769, 1051, 2094, 60, 172, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
